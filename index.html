<!DOCTYPE html>
<html lang="pt-BR">
<head>
ย <meta charset="UTF-8" />
ย <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
ย <title>COPA PATOTA - Apostas</title>
ย <link rel="stylesheet" href="style.css" />
ย <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
ย <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
ย <div class="container">
    <img src="copapatota.png" alt="Logo Copa Patota" class="header-logo" />
ย ย <h1>COPA PATOTA - Apostas</h1>
ย ยย
ย ย <label for="apostador">Seu nome:</label>
ย ย <input type="text" id="apostador" name="apostador" required placeholder="Digite seu nome" />

ย ย <h2>Vote nos Vencedores dos Jogos</h2>
ย ย <div class="jogos-multiplos">
ย ย ย <h2>Aposta Mรบltipla: Acertos nos 6 Jogos</h2>
ย ย ย <form id="form-multipla">
ย ย ย ย <div id="selecao-jogos-multiplos">
ย ย ย ย ย <div class="jogo-container">
ย ย ย ย ย ย <label>Jogo 1: CFC vs Monobolas
ย ย ย ย ย ย ย <select name="jogo1">
ย ย ย ย ย ย ย ย <option value="cfc">CFC</option>
ย ย ย ย ย ย ย ย <option value="monobolas">Monobolas</option>
ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </label>
ย ย ย ย ย ย <canvas id="grafico-jogo1" class="grafico-jogo"></canvas>
ย ย ย ย ย </div>

ย ย ย ย ย <div class="jogo-container">
ย ย ย ย ย ย <label>Jogo 2: Chupiscos vs DST
ย ย ย ย ย ย ย <select name="jogo2">
ย ย ย ย ย ย ย ย <option value="chupiscos">Chupiscos</option>
ย ย ย ย ย ย ย ย <option value="dst">DST</option>
ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </label>
ย ย ย ย ย ย <canvas id="grafico-jogo2" class="grafico-jogo"></canvas>
ย ย ย ย ย </div>

ย ย ย ย ย <div class="jogo-container">
ย ย ย ย ย ย <label>Jogo 3: CFC vs DST
ย ย ย ย ย ย ย <select name="jogo3">
ย ย ย ย ย ย ย ย <option value="cfc">CFC</option>
ย ย ย ย ย ย ย ย <option value="dst">DST</option>
ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </label>
ย ย ย ย ย ย <canvas id="grafico-jogo3" class="grafico-jogo"></canvas>
ย ย ย ย ย </div>

ย ย ย ย ย <div class="jogo-container">
ย ย ย ย ย ย <label>Jogo 4: Chupiscos vs Monobolas
ย ย ย ย ย ย ย <select name="jogo4">
ย ย ย ย ย ย ย ย <option value="chupiscos">Chupiscos</option>
ย ย ย ย ย ย ย ย <option value="monobolas">Monobolas</option>
ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </label>
ย ย ย ย ย ย <canvas id="grafico-jogo4" class="grafico-jogo"></canvas>
ย ย ย ย ย </div>

ย ย ย ย ย <div class="jogo-container">
ย ย ย ย ย ย <label>Jogo 5: Chupiscos vs CFC
ย ย ย ย ย ย ย <select name="jogo5">
ย ย ย ย ย ย ย ย <option value="chupiscos">Chupiscos</option>
ย ย ย ย ย ย ย ย <option value="cfc">CFC</option>
ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </label>
ย ย ย ย ย ย <canvas id="grafico-jogo5" class="grafico-jogo"></canvas>
ย ย ย ย ย </div>

ย ย ย ย ย <div class="jogo-container">
ย ย ย ย ย ย <label>Jogo 6: Monobolas vs DST
ย ย ย ย ย ย ย <select name="jogo6">
ย ย ย ย ย ย ย ย <option value="monobolas">Monobolas</option>
ย ย ย ย ย ย ย ย <option value="dst">DST</option>
ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </label>
ย ย ย ย ย ย <canvas id="grafico-jogo6" class="grafico-jogo"></canvas>
ย ย ย ย ย </div>
ย ย ย ย </div>
ย ย ย ย <button type="submit" style="margin-top: 10px;">Confirmar Aposta Mรบltipla</button>
ย ย ย </form>
ย ย ย <div class="resultado" id="resultado-multipla">
ย ย ย ย Nenhuma aposta mรบltipla registrada ainda.
ย ย ย </div>
ย ย </div>

ย ย <div class="final">
ย ย ย <h2>Quem serรก o Campeรฃo da Final?</h2>
ย ย ย <div class="jogo">
ย ย ย ย <button onclick="votarFinal('cfc')">
ย ย ย ย ย <img src="cabaco.png" alt="CFC Logo" class="team-logo" />CFC
ย ย ย ย </button>
ย ย ย ย <button onclick="votarFinal('dst')">
ย ย ย ย ย <img src="estressados.png" alt="DST FC Logo" class="team-logo" />DST FC
ย ย ย ย </button>
ย ย ย ย <button onclick="votarFinal('chupisco')">
ย ย ย ย ย <img src="chupisco.png" alt="Chupisco FC Logo" class="team-logo" />Chupisco FC
ย ย ย ย </button>
ย ย ย ย <button onclick="votarFinal('monobola')">
ย ย ย ย ย <img src="monobola.png" alt="Monobola RFC Logo" class="team-logo" />Monobola RFC
ย ย ย ย </button>
ย ย ย </div>
ย ย ย <div class="resultado" id="final-resultado">
ย ย ย ย Votos para o campeรฃo: <br />
ย ย ย ย CFC: <span id="final-cfc">0</span> |
ย ย ย ย DST: <span id="final-dst">0</span> |
ย ย ย ย Chupisco FC: <span id="final-chupisco">0</span> |
ย ย ย ย Monobola RFC: <span id="final-monobola">0</span>
ย ย ย </div>
ย ย ย <h2 style="text-align:center;">Grรกfico de Votos da Final</h2>
ย ย ย <canvas id="graficoFinal" width="400" height="400"></canvas>
ย ย </div>
ย ย <div class="tabela-times">
ย ย ย <h2>๐ Tabela de Times Final</h2>
ย ย ย <table>
ย ย ย ย <thead>
ย ย ย ย ย <tr>
ย ย ย ย ย ย <th>Time</th>
ย ย ย ย ย ย <th>Ataque</th>
ย ย ย ย ย ย <th>Meio</th>
ย ย ย ย ย ย <th>Defesa</th>
ย ย ย ย ย ย <th>T</th>
ย ย ย ย ย ย <th>Faltam</th>
ย ย ย ย ย </tr>
ย ย ย ย </thead>
ย ย ย ย <tbody>
ย ย ย ย ย <tr>
ย ย ย ย ย ย <td><strong>CFC</strong></td>
ย ย ย ย ย ย <td>Nicolau (3)</td>
ย ย ย ย ย ย <td>Tururu (3), Felipe (4)</td>
ย ย ย ย ย ย <td>Romulo (4), Arthur (1)</td>
ย ย ย ย ย ย <td>15</td>
ย ย ย ย ย ย <td><span class="status-completo">โ Completo</span></td>
ย ย ย ย ย </tr>
ย ย ย ย ย <tr>
ย ย ย ย ย ย <td><strong>DST FC</strong></td>
ย ย ย ย ย ย <td>Julio (4)</td>
ย ย ย ย ย ย <td>Rodriguinho (3), Gilberto (2)</td>
ย ย ย ย ย ย <td>Benjamim (3), Gordo (3)</td>
ย ย ย ย ย ย <td>15</td>
ย ย ย ย ย ย <td><span class="status-completo">โ Completo</span></td>
ย ย ย ย ย </tr>
ย ย ย ย ย <tr>
ย ย ย ย ย ย <td><strong>MAGO FC</strong></td>
ย ย ย ย ย ย <td>Rafa (4)</td>
ย ย ย ย ย ย <td>Heitor (4), <strong>Marinho</strong> (1)</td>
ย ย ย ย ย ย <td>Henryco (3), Kelvys (3)</td>
ย ย ย ย ย ย <td>15</td>
ย ย ย ย ย ย <td><span class="status-completo">โ Completo</span></td>
ย ย ย ย ย </tr>
ย ย ย ย ย <tr>
ย ย ย ย ย ย <td><strong>Monobola RFC</strong></td>
ย ย ย ย ย ย <td>Diego (4)</td>
ย ย ย ย ย ย <td>Pedro (3.5), Nicolas (1)</td>
ย ย ย ย ย ย <td>Salsicha (4), Luiz Paulo (2)</td>
ย ย ย ย ย ย <td>14.5</td>
ย ย ย ย ย ย <td><span class="status-completo">โ Completo</span></td>
ย ย ย ย ย </tr>
ย ย ย ย </tbody>
ย ย ย </table>
ย ย </div>

ย ย <footer>
ย ย ย ยฉ 2025 COPA PATOTA. Todos os direitos reservados.
ย ย </footer>
ย </div>

ย <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
ย <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database-compat.js"></script>
ย <script>
ย const firebaseConfig = {
ย ย apiKey: "AIzaSyAPSO_BV6U0l2uJ9xdGtTg1CjQhUbUYv9Q",
ย ย authDomain: "copapatota.firebaseapp.com",
ย ย databaseURL: "https://copapatota-default-rtdb.firebaseio.com",
ย ย projectId: "copapatota",
ย ย storageBucket: "copapatota.appspot.com",
ย ย messagingSenderId: "916525284122",
ย ย appId: "1:916525284122:web:b03f134cdd375d3436caa3"
ย };

ย // ... (seu cรณdigo firebaseConfig e db permanece o mesmo) ...

ย firebase.initializeApp(firebaseConfig);
ย const db = firebase.database();

ย // Grรกfico da final
ย const graficoPizza = new Chart(document.getElementById('graficoFinal'), {
ย ย type: 'pie',
ย ย data: {
ย ย ย labels: ['CFC', 'DST', 'Chupisco FC', 'Monobola RFC'],
ย ย ย datasets: [{
ย ย ย ย data: [0, 0, 0, 0],
ย ย ย ย backgroundColor: ['#1f2c5c', '#e74c3c', '#7f8c8d', '#000000']
ย ย ย }]
ย ย },
ย ย options: {
ย ย ย responsive: true,
ย ย ย plugins: {
ย ย ย ย legend: { position: 'bottom' }
ย ย ย }
ย ย }
ย });

ย function atualizarGraficoPizza(dados) {
ย ย graficoPizza.data.datasets[0].data = [
ย ย ย dados.cfc || 0,
ย ย ย dados.dst || 0,
ย ย ย dados.chupisco || 0,
ย ย ย dados.monobola || 0
ย ย ];
ย ย graficoPizza.update();
ย }

ย function atualizarVotos() {
ย ย db.ref('votacaoFinal').on('value', snap => {
ย ย ย const d = snap.val() || {};
ย ย ย document.getElementById("final-cfc").textContent = d.cfc || 0;
ย ย ย document.getElementById("final-dst").textContent = d.dst || 0;
ย ย ย document.getElementById("final-chupisco").textContent = d.chupisco || 0;
ย ย ย document.getElementById("final-monobola").textContent = d.monobola || 0;
ย ย ย atualizarGraficoPizza(d);
ย ย });
ย }

ย atualizarVotos();

ย function votarFinal(time) {
ย ย const nomeApostador = document.getElementById("apostador").value.trim();
ย ย if (!nomeApostador) {
ย ย ย alert("Por favor, digite seu nome antes de votar na final!");
ย ย ย return;
ย ย }
ย ย db.ref('votosFinaisPorNome/' + nomeApostador).once('value')
ย ย ย .then(snapshot => {
ย ย ย ย if (snapshot.exists()) {
ย ย ย ย ย alert("Vocรช (ou alguรฉm com este nome) jรก votou na final!");
ย ย ย ย } else {
ย ย ย ย ย db.ref('votosFinaisPorNome/' + nomeApostador).set(time);
ย ย ย ย ย db.ref('votacaoFinal/' + time).transaction(v => (v || 0) + 1);
ย ย ย ย ย alert("Voto registrado!");
ย ย ย ย }
ย ย ย })
ย ย ย .catch(error => {
ย ย ย ย console.error("Erro ao votar na final:", error);
ย ย ย ย alert("Ocorreu um erro ao registrar seu voto. Tente novamente.");
ย ย ย });
ย }


ย // Grรกficos dos jogos
ย const graficosJogos = {};
ย const nomesJogos = [
ย ย ['cfc', 'monobolas'],
ย ย ['chupiscos', 'dst'],
ย ย ['cfc', 'dst'],
ย ย ['chupiscos', 'monobolas'],
ย ย ['chupiscos', 'cfc'],
ย ย ['monobolas', 'dst']
ย ];

ย const coresTimes = {
ย ย cfc: '#1f2c5c',
ย ย dst: '#e74c3c',
ย ย chupiscos: '#7f8c8d',
ย ย monobolas: '#000000'
ย };

ย nomesJogos.forEach((times, i) => {
ย ย const idCanvas = `grafico-jogo${i + 1}`;
ย ย const ctx = document.getElementById(idCanvas).getContext('2d');
ย ย const jogoKey = `jogo${i + 1}`;

ย ย // ***** ALTERAรรO CHAVE AQUI: Definindo o aspectRatio e maintainAspectRatio para controlar o tamanho *****
ย ย graficosJogos[jogoKey] = new Chart(ctx, {
ย ย ย type: 'pie',
ย ย ย data: {
ย ย ย ย labels: times,
ย ย ย ย datasets: [{
ย ย ย ย ย data: [0, 0],
ย ย ย ย ย backgroundColor: times.map(t => coresTimes[t])
ย ย ย ย }]
ย ย ย },
ย ย ย options: {
ย ย ย ย responsive: true,
        maintainAspectRatio: false, // Permite que o grรกfico use o tamanho do contรชiner sem tentar manter uma proporรงรฃo rรญgida
        aspectRatio: 1, // Proporรงรฃo 1:1, (quadrado). Pode ajustar para outros valores se quiser retangular.
ย ย ย ย plugins: {
ย ย ย ย ย legend: { position: 'bottom' }
ย ย ย ย }
ย ย ย }
ย ย });

ย ย db.ref('apostasMultiplas').on('value', snap => {
ย ย ย const apostas = snap.val() || {};
        let contagem = {};
        times.forEach(team => contagem[team] = 0);
        Object.values(apostas).forEach(ap => {
            const escolha = ap[jogoKey];
            if (contagem.hasOwnProperty(escolha)) {
                contagem[escolha]++;
            }
        });

ย ย ย graficosJogos[jogoKey].data.datasets[0].data = [contagem[times[0]], contagem[times[1]]];
ย ย ย graficosJogos[jogoKey].update();
ย ย });
ย });

ย // Formulรกrio mรบltipla
ย document.getElementById("form-multipla").addEventListener("submit", function(e) {
ย ย e.preventDefault();
ย ย const nome = document.getElementById("apostador").value.trim();
ย ย if (!nome) return alert("Digite seu nome!");

ย ย const formData = new FormData(this);
ย ย const aposta = { nome };
ย ย formData.forEach((value, key) => {
        if (value === 'estressados') {
            aposta[key] = 'dst';
        } else {
            aposta[key] = value;
        }
    });

ย ย db.ref('apostasMultiplasPorNome/' + nome).once('value')
ย ย ย .then(snapshot => {
ย ย ย ย if (snapshot.exists()) {
ย ย ย ย ย alert("Vocรช (ou alguรฉm com este nome) jรก registrou uma aposta mรบltipla!");
ย ย ย ย } else {
ย ย ย ย ย db.ref("apostasMultiplas/" + Date.now()).set(aposta);
ย ย ย ย ย db.ref('apostasMultiplasPorNome/' + nome).set(true);
ย ย ย ย ย document.getElementById("resultado-multipla").innerText = `Aposta registrada para ${nome}!`;
ย ย ย ย ย this.reset();
ย ย ย ย ย document.getElementById("apostador").value = nome;
ย ย ย ย }
ย ย ย })
ย ย ย .catch(error => {
ย ย ย ย console.error("Erro ao registrar a aposta mรบltipla:", error);
ย ย ย ย alert("Ocorreu um erro ao registrar sua aposta. Tente novamente.");
ย ย ย });
ย });
</script>
